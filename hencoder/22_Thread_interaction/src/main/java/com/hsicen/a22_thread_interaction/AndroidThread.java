package com.hsicen.a22_thread_interaction;/** * 作者：hsicen  8/26/21 22:37 * 邮箱：codinghuang@163.com * 作用： * 描述：Android消息机制简单实现 */public class AndroidThread {    private final CustomizeThread thread = new CustomizeThread();    public static void main(String[] args) {        AndroidThread androidThread = new AndroidThread();        androidThread.start();    }    public void start() {        thread.start();        thread.setTask(new Runnable() {            @Override            public void run() {                System.out.println("Task from outside.");            }        });        try {            Thread.sleep(2000);            quit();        } catch (InterruptedException e) {            e.printStackTrace();        }    }    public void quit() {        thread.setQuit(true);    }    // 相当于HandlerThread    static class CustomizeThread extends Thread {        private final Looper looper = new Looper();        @Override        public void run() {            super.run();            looper.loop();        }        public void setQuit(boolean b) {            looper.setQuit(b);        }        public void setTask(Runnable runnable) {            looper.setTask(runnable);        }    }    static class Looper {        private volatile boolean quit;        private Runnable task;        public void setTask(Runnable task) {            this.task = task;        }        public void setQuit(boolean quit) {            this.quit = quit;        }        public void loop() {            while (!quit) {                synchronized (this) {                    if (null != task) {                        task.run();                        task = null;                    }                }            }        }    }}